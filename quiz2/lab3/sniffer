#include "kernel/types.h"
#include "kernel/fcntl.h"
#include "user/user.h"
#include "kernel/riscv.h"

#define ALLOC_SIZE (64 * 4096)

int main(int argc, char *argv[])
{
  char *mem;
  char *marker = "This may help.";
  int i, j;

  mem = sbrk(ALLOC_SIZE);
  if (mem == (char *)-1)
  {
    printf("sbrk failed\n");
    exit(1);
  }

  for (i = 0; i < ALLOC_SIZE - 64; i++)
  {
    int match = 1;
    for (j = 0; j < 14; j++)
    {
      if (mem[i + j] != marker[j])
      {
        match = 0;
        break;
      }
    }

    if (match)
    {
      char *secret_ptr = &mem[i + 16];
      if (secret_ptr[0] > 32 && secret_ptr[0] < 127 && secret_ptr[0] != '(')
      {
        printf("%s\n", secret_ptr);
        exit(0);
      }
    }
  }

  printf("Secret not found\n");
  exit(1);
}
